<!DOCTYPE html>
<html>
  <head>
    <title>SPUC</title>
    <link rel="stylesheet" type="text/css" href="/css/SPUC/main.css" title="Default">
    <script src='/js/SPUC/main.js'></script>
    <meta charset='utf-8'>
  </head>
  
  <body class="col">
    <header class="row">
      
      <div class="splash row">
        <div style="display:flex;flex-direction:column">
          <p>Scarf Poutine You Clone</p>
          <p>Collaborative Comics</p>
        </div>
      </div>
      
      <aside class="column">
      : if $user {
        <p><: $user.get('display_name') :></p>
        : my $ava = $user.get('avatar')
        <a href="?path=/profile">
          : if $ava {
          <img src="<:$ava.size(150,150):>">
        : } else {
          my profile
        : }
        </a>
      
      : } else if $path != '/register' {
      <form method="POST" action="?path=/login">
        <span id="err"><:$err:></span>
        <input type="text" name="un" placeholder="user">
        <input type="password" name="pw" placeholder="password">
        <button type="submit">Log In</button>
        <a href="?path=/register">register</a>
      </form>
      : }
      
      </aside>
      
    </header>
    <nav class="row">
      <a href="?path=/read&sort=recent">read comics</a>
      : if $user {
      <a href="?path=/play">play</a>
      <a href="?path=/start">start a comic</a>
      <a href="?path=/mine&sort=recent">my comics</a>
      <a href="?path=/profile">my profile</a>
      <a href="?path=/logout">log out</a>
      : }
    </nav>

    : if $msg {
    <div class="message"><p><:$msg:></p></div>
    : }

    <main>
      
    : if $path == '/register' && ! $user {
      <form method="POST" action="?path=/register">
        <input type="email" name="em" placeholder="email" value="<:$params['em']:>">
        <input type="text" name="un" placeholder="user" value="<:$params.un:>"> 
        <input type="password" name="pw" placeholder="password" value="<:$params.pw:>">
        <input type="password" name="pw2" placeholder="repeat password">
        <span id="err"><:$err:></span>
        <button type="submit">Register Account</button>
        <a href="?path=/">cancel</a>
        <script src="/js/SPUC/register.js"></script>
      </form>
      : }

      : if $path == '/profile' && $user {
        : include "profile.tx"
      : } else if( $path == '/play' && $user ) {
        : include "play.tx"
      : } else if $path == '/start' && $user {
        : include "start.tx"
      : } else { #read is the default
        : include "read.tx"
      : }
      
      
    </main>

    <hr>
    <footer class="message" style="margin-top:100px">
      Min Viable Product
      TODOS
      <ul>
        <li>locking comics and other objects</li>
      </ul>
      Other TODOS
      <ul>
        <li>admin class user</li>
        <li>in progress comics</li>
        <li>bookmarks for comics</li>

        <li>make sure only one user is playing a comic</li>

        <li>testing comic</li>
        <li>UI advice</li>
        
        <li>comic comments</li>
        <li>kudos</li>

        <li>group chat</li>
        
        <li>images on the filesystem</li>
        <li>permissions/group datastore. Maybe a spuc admin group?</li>
        
        <li>spuc_admin.pl actions</li>
        <li>show admins</li>
        <li>log view for admin</li>
        <li>logging for all things done</li>
        
        <li>porting comics and users</li>
        
        <li>RPC</li>
        <li>yote js -> server</li>
      </ul>
    </footer>
    
  </body>
</html>

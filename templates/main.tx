<!DOCTYPE html>
<html>
  <head>
    <title>SPUC</title>
    <link rel="stylesheet" type="text/css" href="/css/SPUC/main.css" title="Default">
    <script src='/js/SPUC/main.js'></script>
  </head>
  
  <body>
    <header>
      <div id="splash">
        <p>Scarf Poutine You Clone</p>
        <div style="background:url(/spuc.png) no-repeat;width:300px;height:150px;display:flex;flex-direction:column;align-content:space-between;">
        </div>
        <p>Collaborative Comics</p>
      </div>
      : if $user {
      <div id="userhead">
        <: $user.get('display_name') :>
        : my $ava = $user.get('avatar')
        <a href="?path=/profile">
          : if $ava {
          <img src="<:$ava.size(100,100):>">
        : } else {
          my profile
        : }
        </a>
        <a href="?path=/logout">log out</a>
      </div>
      : } else if $path != '/register' {
      <form method="POST" action="?path=/login">
        <: $loginerror :>
        <input type="text" name="un" placeholder="user">
        <input type="password" name="pw" placeholder="password">
        <button type="submit">Log In</button>
        <a href="?path=/register">register</a>
      </form>
      : }
    </header>

    : if $msg {
    <div class="message"><p><:$msg:></p></div>
    : }

    <main>
      
    : if $path == '/register' && ! $user {
      <form method="POST" action="?path=/register">
        <input type="email" name="em" placeholder="email" value="<:$params['em']:>">
        <input type="text" name="un" placeholder="user" value="<:$params.un:>"> 
        <input type="password" name="pw" placeholder="password" value="<:$params.pw:>">
        <input type="password" name="pw2" placeholder="repeat password">
        <span id="err"><:$err:></span>
        <button type="submit">Register Account</button>
        <a href="?path=/">cancel</a>
        <script src="/js/SPUC/register.js"></script>
      </form>
      : }

      : if $path == '/profile' && $user {
        : my $selava = $user.get('avatar')
        : my $avas = $user.get('_avatars')
      
      <div class="profile" >
        <p class="info">Editing Profile</p>
        <section>
          <h2>Avatars</h2>
          <p>You can upload multiple avatars and select the one you want to be shown.</p>
          <div style="flex-direction: row; display: flex;">
            : for $avas -> $ava {
              : if $ava == $selava {
            <div style="border: solid 3px black">
              <img src="<:$ava.size(100,100):>" style="margin:auto">
            </div>
              : } else {
            <a href="?path=/profile&avatar=<:$ava._id:>">
              <img src="<:$ava.size(100,100):>" style="margin:auto">
            </a>
              : }
            : }
          </div>
          <form method="POST" action="?path=/profile" enctype="multipart/form-data">
            Upload New Avatar
            <input name="avup" type="file">
            <button style="margin:auto" type="submit">upload</button>
          </form>
          
          <a href="#">Draw New Avatar</a>
          
          <div id="ava_edit">
            : include "editor.tx"
          </div>
        </section>
        
        <script src="/js/SPUC/profile.js"></script>
      </div>
      : }
      
    </main>

    <div class="message">
      TODOS
      <ul>
        <li>avatar drawing -> image</li>

        <li>image sizes and resizing</li>
        <li>reediting images, copying and deleting them</li>

        
        <li>RPC</li>
        <li>yote js -> server</li>

        <li>permissions/group datastore. Maybe a spuc admin group?</li>
        <li>spuc_admin.pl actions</li>
        <li>porting comics and users</li>
        <li>begin comic</li>
        <li>presenting comics</li>
        <li>comic comments</li>
        <li>kudos</li>
        <li>panel upload vs drawing</li>
        <li>image resizing/scaling</li>
        <li>integrate drawing tool</li>
      </ul>
    </div>
    
  </body>
</html>
